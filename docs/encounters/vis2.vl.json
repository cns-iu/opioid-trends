{
    "$schema": "https://vega.github.io/schema/vega-lite/v4.json",
    "mark": "bar",
    "data": {
      "url" : "http://localhost:6027/data/encounters-insurance-data.csv",
      "format": {
        "parse": {
          "TOTAL": "number"
        }
      }
    },
    "transform": [
      {
        "calculate": "datum.COMMERCIAL / datum.TOTAL * 100",
        "as": "COMMERCIAL_PERCENT"
      },
      {
        "calculate": "datum.OTHER_GOV / datum.TOTAL * 100",
        "as": "OTHER_GOV_PERCENT"
      },
      {
        "calculate": "datum.SELF_PAY / datum.TOTAL * 100",
        "as": "SELF_PAY_PERCENT"
      },
      {
        "calculate": "datum.WORKERS_COMP / datum.TOTAL * 100",
        "as": "WORKERS_COMP_PERCENT"
      },
      {
        "calculate": "datum.INSTITUTIONALIZED / datum.TOTAL * 100",
        "as": "INSTITUTIONALIZED_PERCENT"
      },
      {
        "calculate": "datum.CHARITY / datum.TOTAL * 100",
        "as": "CHARITY_PERCENT"
      },
      {
        "calculate": "datum.MEDICARE / datum.TOTAL * 100",
        "as": "MEDICARE_PERCENT"
      },
      {
        "calculate": "datum.MEDICAID / datum.TOTAL * 100",
        "as": "MEDICAID_PERCENT"
      },
      {
        "calculate": "datum.NO_DATA / datum.TOTAL * 100",
        "as": "NO_DATA_PERCENT"
      }
    ]
  }